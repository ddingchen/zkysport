var gundong_1;//时间轮1var gundong_2;//时间轮2var time_X = 0;//时间选择判定,如果有时间选择,PHP输出1,没有写0var xx;//场地类型参数,羽毛球1,乒乓球2,篮球3,足球4var input1 = 0;var input2 = 0;var x_d;$(function () {    var mydate = new Date();    var riqi1 = dd(mydate);    mydate.setDate(mydate.getDate() + 1);    var riqi2 = dd(mydate);    mydate.setDate(mydate.getDate() + 1);    var riqi3 = dd(mydate);    $("#gundong1 ul li:nth-child(3)").attr("data-id", riqi1);    $("#gundong1 ul li:nth-child(4)").attr("data-id", riqi2);    $("#gundong1 ul li:nth-child(5)").attr("data-id", riqi3);    $("li").css({"font-size": "3.6rem"});    $("li").css({"color": "#464950"});    xx = $("#leixing").val();    panduan();    gaodu();    $(".gunlun").hide();    /*$('#input1').on("touchstart", function () {     if (input1 == 0) {     $('#input1').val("");     $('#input1').css("color", "#707072");     input1 = 1;     }     });     $('#input2').on("touchstart", function () {     if (input2 == 0) {     $('#input2').val("");     $('#input2').css("color", "#707072");     input2 = 1;     }     });*/    $("#number").blur(function () {        n = $("#number").val();        if (n >= 99) {            n = 99;        } else if (n < 1) {            n = 1;        }        $("#number").val(n);    });    $('.time').on("touchstart", function () {        //shijian()        $("#kongbai").show();        $(".gunlun").css('left', '0');        if (!gundong_1) {            $(".gunlun").show();            $("#gundong3").attr("src", asset + "changdiyuding_gundong.php?i=0");            shijian();        }    });    $('.gunlun_quxiao').on("touchstart", function () {        $(".gunlun").css('left', '-1000px');        $("#kongbai").css("background-color", "rgba(0,0,0,0)");        $("#kongbai").slideUp("1500", function () {            $("#kongbai").css("background-color", "rgba(0,0,0,0.5)");        });    });    $('.gunlun_queren').on("touchstart", function () {//收集时间数据        zzz();        $(".gunlun").css('left', '-1000px');        $("#day").html(x);        $("#time1").html(y);        $("#time2").html(z);        time_X = 1;        $("#kongbai").css("background-color", "rgba(0,0,0,0)");        $("#kongbai").slideUp("1500", function () {            $("#kongbai").css("background-color", "rgba(0,0,0,0.5)");        });        $("#changdi").val('');        $("#changdi_haoma").html('');    });});//页面各种判断function panduan() {    //运动类型判断    // xx = parseInt(xx);    switch (xx) {        case 'badminton':            $("#renshu").hide();            $("#kongbai").hide();            var xm = '<div class="cgyd2 div_h"><img src="img/Badminton.png">羽毛球</div>';            break;        case 'pingpong':            $("#kongbai").hide();            pingpangqiu();            var xm = '<div class="cgyd2 div_h"><img src="img/Table%20tennis.png">乒乓球</div>';            break;        case 'basketball':            lanqiu();            $("#kongbai").hide();            $("#renshu").hide();            var xm = '<div class="cgyd2 div_h"><img src="img/basketball.png">篮球</div>';            break;        case 'football':            $("#renshu").hide();            $("#kongbai").hide();            var xm = '<div class="cgyd2 div_h"><img src="img/football.png">足球</div>';            break;    }    $("#xiangmu").html(xm);    $("#xiangmu").show();    //姓名电话判断    /*var input1_x = $('#input1').val();     var input2_x = $('#input2').val();     if (input1_x && input1_x !== "预约人姓名") {     $('#input1').css("color", "#707072");     input1=1;     }     if (input2_x && input2_x !== "预约电话") {     $('#input2').css("color", "#707072");     input2=1;     }*/    //时间判断    x = $("#xxx").val();    y = $("#yyy").val();    z = $("#zzz").val();    if (x) {        var today = new Date();        today.setHours(8);        today.setMinutes(0);        today.setSeconds(0);        today.setMilliseconds(0);        var Date_x = new Date(x);        var x_day = (Date_x - today) / 86400000;        switch (x_day) {            case 0:                $("#day").html('今天');                break;            case 1:                $("#day").html('明天');                break;            case 1:                $("#day").html('后天');                break;        }    }    if (y) {        $("#time1").html(y);    }    if (z) {        $("#time2").html(z);    }    if (x && y && z) {        time_X = 1;    }    //场地号判断    var areaType = $("#areatype").val();    if (areaType) {        $("#changdi_haoma").html(getSelectedItemName(xx, areaType));    } else {        var selectedAreaIdJson = $("#changdi").val();        if (selectedAreaIdJson) {            var areaDict = $.parseJSON($('#areaSelectsJson').val());            var selectedAreaNames = [];            var selectedAreaIdArray = $.parseJSON(selectedAreaIdJson);            for (var index in selectedAreaIdArray) {                var areaId = selectedAreaIdArray[index];                selectedAreaNames.push(areaDict[xx][areaId]);            }            $("#changdi_haoma").html(selectedAreaNames.toString());        }    }}function getSelectedItemName(sportType, selectedValue) {    var elemId = '';    switch (sportType) {        case 'basketball':            elemId = 'changdi3';            break;        case 'football':            elemId = 'changdi4';            break;    }    return $('#' + elemId + '>div[data-id=' + selectedValue + ']').text();}//页面各高度自适应function gaodu() {    var height = $(window).height();    var width = $(window).width();    var bili = 1 / 750 * width;//页面比例    var ziti = 10 * bili;//字体自适应参数    var xian = 4 * bili;//边框    $("#kongbai").css("height", height);    $("html").css("font-size", ziti + "px");    $(".gekai").css("margin-left", '6.5%');    $(".xian").css("width", '100%');}//项目类型选择function load() {    $(".cgyd2_xm").on("touchstart", function () {        var leixing = $(this).attr("data-id");        leixin(leixing);        var xm = '<div class="cgyd2 div_h">' + $(this).html() + '</div>';        $("#xiangmu").html(xm);        $("#kongbai").css("background-color", "rgba(0,0,0,0)");        $("#kongbai").slideUp("1500", function () {            $("#kongbai").css("background-color", "rgba(0,0,0,0.5)");        });    });}//项目类型选择function pingpangqiu() {    $("#gundong1 ul li:nth-child(3)").html('明天');    $("#gundong1 ul li:nth-child(4)").html('后天');    $("#gundong1 ul li:nth-child(5)").html('');    $("#gundong1 ul li:nth-child(7)").remove();    var mydate = new Date();    var riqi1 = dd(mydate);    mydate.setDate(mydate.getDate() + 1);    var riqi2 = dd(mydate);    mydate.setDate(mydate.getDate() + 1);    var riqi3 = dd(mydate);    $("#gundong1 ul li:nth-child(3)").attr("data-id", riqi2);    $("#gundong1 ul li:nth-child(4)").attr("data-id", riqi3);    $("#gundong1 ul li:nth-child(5)").attr("data-id", '');    $('#day').html("明天");}function lanqiu() {    $("#bolangxian").hide();    $("#gundong2").hide();    $("#gundong3").hide();    $("#time1").hide();    $("#time2").hide();    $("#time_x").hide();    $("#gundong1").css({'width': '100%', 'margin': '0'});    $("#gundong1 ul li:nth-child(3)").html('明天');    $("#gundong1 ul li:nth-child(4)").html('后天');    $("#gundong1 ul li:nth-child(5)").html('');    $("#gundong1 ul li:nth-child(7)").remove();    var mydate = new Date();    var riqi1 = dd(mydate);    mydate.setDate(mydate.getDate() + 1);    var riqi2 = dd(mydate);    mydate.setDate(mydate.getDate() + 1);    var riqi3 = dd(mydate);    $("#gundong1 ul li:nth-child(3)").attr("data-id", riqi2);    $("#gundong1 ul li:nth-child(4)").attr("data-id", riqi3);    $("#gundong1 ul li:nth-child(5)").attr("data-id", '');    time_X = 1;    $('#day').html("明天");    $('#xxx').val(riqi2);}function leixin(i) {    // i = parseInt(i);    switch (i) {        case 'badminton':            $("#renshu").hide();            xx = 'badminton';            break;        case 'pingpong':            pingpangqiu();            xx = 'pingpong';            break;        case 'basketball':            lanqiu();            $("#renshu").hide();            xx = 'basketball';            break;        case 'football':            $("#renshu").hide();            xx = 'football';            break;    }    $("#leixing").val(xx);}//人数选择function num123(m) {    try {        var n = parseInt($("#number").val());        n = n + m;        if (n >= 99) {            n = 99;        } else if (n < 1) {            n = 1;        }        $("#number").val(n);    } catch (e) {        alert(e);    }}//时间滚轮function shijian() {    gundong_1 = new iScroll("gundong1", {        snap: "li",        momentum: true,        hScrollbar: false,        vScrollbar: false,        bounce: false, //是否超过实际位置反弹        wheelAction: 'scroll', //鼠标滚动行为（还可以是zoom）        hScroll: false, //是否水平滚动        // onTouchEnd: function () {        //     zzz();        // }, //在滚动完成后的回调    });    gundong_2 = new iScroll("gundong2", {        snap: "li",        momentum: true,        hScrollbar: false,        vScrollbar: false,        hScroll: false, //是否水平滚动        bounce: false, //是否超过实际位置反弹        wheelAction: 'scroll', //鼠标滚动行为（还可以是zoom）        onTouchEnd: function () {            bianhua();        }, //在滚动完成后的回调    });}function bianhua() {    var y = gundong_2.currPageY;    $("#gundong3").attr("src", asset + "changdiyuding_gundong.php?i=" + y);}function zzz() {    var twohourslater = new Date(new Date().getTime() + (2*60*60*1000));    var year = twohourslater.getFullYear();    var month = twohourslater.getMonth()+1;    var date = twohourslater.getDate() ;    var hour = twohourslater.getHours();    var min = twohourslater.getMinutes();    var nowFormat = year+'-'+month+'-'+date+hour+':'+min;    x = gundong_1.currPageY;    y = gundong_2.currPageY;    if (x >= 3) {        x = 3;    }    x += 3;    if (y >= 19) {        y = 19;    }    y += 3;    x_d = $("#gundong1 ul li:nth-child(" + x + ")").attr("data-id");    x = $("#gundong1 ul li:nth-child(" + x + ")").html();    y = $("#gundong2 ul li:nth-child(" + y + ")").html();       z = gg();     if(nowFormat>x_d+y){        alert('仅提供2小时后的预订！');        return;    }    $("#xxx").val(x_d);    $("#yyy").val(y);    $("#zzz").val(z);}function gg() {    ofrm1 = document.getElementById("gundong3").contentWindow.document;    var ff = ofrm1.getElementById("gg3").value;    return ff;}//场地类型选择器function xzcd() {    if ($('#yyy').val()) {        var input1_x = $("#input1").val();        var input2_x = $("#input2").val();        if (input1_x && input2_x) {            switch (xx) {                case 'badminton':                case 'pingpong':                    flashInput(function () {                        location.href = '/sport/' + xx + '/area';                    });                    break;                case 'basketball':                    $("#changdi3").show();                    $("#kongbai").show();                    break;                case 'football':                    $("#changdi4").show();                    $("#kongbai").show();                    break;            }        } else {            alert("请正确填写用户信息");        }    } else {        alert("请选择预定时间");    }}function flashInput(callback) {    $.get('/sport/flash', $('form').serialize(), callback);}//场地选择(足球篮球)$(function () {    $(".changdi div").on("touchstart", function () {        var cd = $(this).attr("data-id");        var cd2 = $(this).html();        if (cd) {            $("#areatype").val(cd);            $("#changdi_haoma").html(cd2);            $('#loading').show();            attempAssign();        }        $(".changdi").hide();        $("#kongbai").css("background-color", "rgba(0,0,0,0)");        $("#kongbai").slideUp("1500", function () {            $("#kongbai").css("background-color", "rgba(0,0,0,0.5)");        });    });});function attempAssign() {    $.ajax({        type: 'post',        url: 'sport/attempt',        data: $('form').serialize(),        dataType: 'json',        success: function (data) {            // success logic            $('#loading').hide();            if (data && data.length > 0) {                $("#changdi").val(JSON.stringify(data));            } else {                $("#areatype").val('');                $("#changdi_haoma").html('');                alert('已被预订完!');            }            console.log(JSON.stringify(data));        },        error: function (data) {            $('#loading').hide();            var errors = data.responseText;            console.log(errors);            // Render the errors with js ...        }    });}function dd(mydate) {    var Year = mydate.getFullYear();    var Month = (mydate.getMonth() + 1);    var Day = mydate.getDate();    if (Month < 10) {        Month = '0' + Month;    }    if (Day < 10) {        Day = '0' + Day;    }    var dd = Year + "-" + Month + '-' + Day;    return dd}